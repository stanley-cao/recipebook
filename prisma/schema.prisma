// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Recipe {
  id               String       @id @default(cuid())
  title            String
  slug             String?      @unique
  description      String?
  coverImage       String?
  images           String[] // postgres text[]
  tags             String[] // postgres text[]
  estimatedMinutes Int?
  steps            Step[]
  ingredients      Ingredient[]
  createdAt        DateTime     @default(now())
  updatedAt        DateTime     @updatedAt
}

model Step {
  id       String  @id @default(cuid())
  index    Int
  text     String
  imageUrl String?
  recipe   Recipe  @relation(fields: [recipeId], references: [id], onDelete: Cascade)
  recipeId String

  @@unique([recipeId, index])
}

model Ingredient {
  id       String  @id @default(cuid())
  name     String
  quantity String?
  recipe   Recipe  @relation(fields: [recipeId], references: [id], onDelete: Cascade)
  recipeId String
}
